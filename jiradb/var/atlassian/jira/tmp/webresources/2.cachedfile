;
/* module-key = 'com.pyxis.greenhopper.jira:gh-rapid-gadget-common', location = 'includes/js/gadgets/greenhopper-common.js' */
AJS.$.namespace("GH.gadget.utils"),GH.gadget.utils.getViewName=function(){var e=new RegExp("[\\?&]view=([^&#]*)"),t=e.exec(window.location.href);return t?t[1].toLowerCase():""},GH.gadget.utils.isWallboardView=function(){var e=GH.gadget.utils.getViewName();return"wallboard"==e},GH.gadget.utils.insertHeaderElements=function(e,t){if(e&&e.length&&!(e.length<1)){var a="<h2>";AJS.$(e).each(function(e,t){e>0&&(a+=" : "),a+=t}),a+="</h2>",AJS.$(a).prependTo(t)}},GH.gadget.utils.getProjectLink=function(e,t){return e.getBaseUrl()+"/browse/"+t},GH.gadget.utils.getVersionLink=function(e,t,a){return GH.gadget.utils.getProjectLink(e,t)+"/fixforversion/"+a},GH.gadget.utils.redirectParent=function(e){window.top.location.href=e},GH.gadget.utils.getProjectLinkMarkup=function(e,t){var a=GH.gadget.utils.getProjectLink(e,t.key);return'<a href="'+a+'"><strong>'+AJS.escapeHTML(String(t.name))+"</strong> ("+t.key+")</a>"},GH.gadget.utils.getVersionLinkMarkup=function(e,t,a){if(a.id)var n=GH.gadget.utils.getVersionLink(e,t.key,a.id);else var n=GH.gadget.utils.getProjectLink(e,t.key);return'<a href="'+n+'" class="gg-days-version"><strong>'+a.name+"</strong></a>"},GH.gadget.utils.getProjectVersionHeaderElements=function(e,t){var a=[],n=t.project,i=t.version,l="true"==e.getPref("showProjectName");l&&a.push(GH.gadget.utils.getProjectLinkMarkup(e,n));var r="true"==e.getPref("showVersionName");return r&&a.push(GH.gadget.utils.getVersionLinkMarkup(e,n,i)),a},GH.gadget.utils.addProjectVersionHeader=function(e,t,a){var n=GH.gadget.utils.getProjectVersionHeaderElements(e,t);GH.gadget.utils.insertHeaderElements(n,a)},GH.gadget.utils.showInlineWarning=function(e,t){var a=e.getView();a.empty(),AJS.messages.warning(a,{autoHide:!1,shadowed:!1,closeable:!1,body:t}),e.resize()},AJS.$.namespace("GH.gadget.fields"),GH.gadget.fields.sectionTitle=function(e,t,a){return{label:"none",id:t,type:"callbackBuilder",callback:function(t){t.parent().children("label").remove(),t.parent().children("#-error").remove();var n="<h3>"+e.getMsg(a)+"</h3>";t.append(AJS.$(n))}}},GH.gadget.fields.checkbox=function(e,t,a,n,i){return{userpref:t,label:e.getMsg(a),id:"checkbox_"+t,type:"callbackBuilder",callback:function(l){l.addClass("checkbox").wrap('<fieldset class="group" />'),l.parent().siblings("label").remove(),l.closest(".field-group").removeClass("field-group"),l.removeClass("builder-container");var r=t+"_checkbox",s=n?" checked":"",c='<input type="checkbox" class="checkbox" id="'+r+'" '+s+" />";c+='<label for="'+r+'">'+e.getMsg(a)+"</label>",c+='<input type="hidden" id="'+t+'" name="'+t+'" value="'+n+'" />',l.append(AJS.$(c)),AJS.$("#"+r,l).each(function(){var e=this,a=AJS.$(e);a.change(function(){var a="#"+t;AJS.$(a).attr("value",e.checked)})}),i&&l.append(AJS.$("<div/>").addClass("description").text(e.getMsg(i)))}}},GH.gadget.fields.updateVersionSelectOptions=function(e,t,a,n,i){var l=AJS.$("#"+a);l.empty();var r=AJS.$.ajax({key:"versions",url:"/rest/greenhopper/1.0/versionBoard-list/generate",data:{showUnscheduled:n,projectId:t},success:function(t){r=t;var n=e.getPref(a);if(i){var s="auto",c=AJS.$("<option />").addClass("next-release-option").val(s).text(e.getMsg("gh.gadget.days.remaining.autoOption"));n==s&&c.attr("selected","selected"),l.append(c)}AJS.$(r.versionOptions).each(function(){if(!i||""!=this.value){var e=AJS.$("<option/>").attr("value",this.value).text(this.label);l.append(e),n==this.value&&e.attr("selected","selected")}})}})},GH.gadget.fields.updateFieldSelectOptions=function(e,t,a,n){var i=AJS.$("#"+a);i.empty();AJS.$.ajax({key:"fields",url:"/rest/greenhopper/1.0/watched-fields/generate",data:{projectId:t,showSystem:n},success:function(t){if(t){var n=t.fields,l=e.getPref(a);AJS.$(n).each(function(){var e=AJS.$("<option/>").attr("value",this.value).text(this.label);i.append(e),l==this.value&&e.attr("selected","selected")})}}})},GH.gadget.fields.updateContextSelectionOptions=function(e,t,a){var n=AJS.$("#"+a);n.empty();var i=AJS.$.ajax({key:"contexts",url:"/rest/greenhopper/1.0/context-list/generate",data:{projectId:t,returnIds:!0},success:function(t){var l=e.getPref(a).split("|");i=t,AJS.$(i.contextOptions).each(function(){var e=AJS.$("<option/>").attr("value",this.value).text(this.label);n.append(e);for(var t=0,a=l.length;t<a;t++)l[t]==this.value&&e.attr("selected","selected")})}})},GH.gadget.fields.updateTBMappingSelectionOptions=function(e,t,a){var n=AJS.$("#"+a);n.empty();AJS.$.ajax({key:"tbmapping",url:"/rest/greenhopper/1.0/tbmapping-list/generate",data:{projectId:t},success:function(t){var i=e.getPref(a).split("|"),l=t;AJS.$(l.tbMappingOptions).each(function(){var t=AJS.$("<option/>").attr("value",this.value).text(e.getMsg(this.label));n.append(t);for(var a=0,l=i.length;a<l;a++)i[a]==this.value&&t.attr("selected","selected")})}})},GH.gadget.fields.projectPicker=function(e,t,a){return{userpref:t,label:e.getMsg("gadget.common.project.label"),id:"project_picker_"+t,type:"callbackBuilder",callback:function(n){n.append(AJS.$("<select/>").attr({id:t,name:t}).addClass("select"));var i=AJS.$("#"+t);i.empty();var l=e.getPref(t);AJS.$(a).each(function(){var e=AJS.$("<option/>").attr("value",this.value).text(this.label);i.append(e),this.value==l&&e.attr({selected:"selected"})})}}},GH.gadget.fields.versionPicker=function(e,t,a,n,i){return{userpref:a,label:e.getMsg("gh.gadget.common.version"),id:"version_picker_"+a,type:"callbackBuilder",callback:function(l){l.append(AJS.$("<select>").attr({id:a,name:a}).addClass("select"));var r=AJS.$("#"+t);GH.gadget.fields.updateVersionSelectOptions(e,r.val(),a,n,i),r.change(function(t){GH.gadget.fields.updateVersionSelectOptions(e,r.val(),a,n,i)})}}},GH.gadget.fields.fieldPicker=function(e,t,a,n){var i="";return i=n?e.getMsg("gh.gadget.task.board.count"):e.getMsg("gh.gadget.custom.field.burndown.field.label"),{userpref:a,label:i,id:"field_picker_"+a,type:"callbackBuilder",callback:function(i){i.append(AJS.$("<select>").attr({id:a,name:a}).addClass("select"));var l=AJS.$("#"+t);GH.gadget.fields.updateFieldSelectOptions(e,l.val(),a,n),l.change(function(t){GH.gadget.fields.updateFieldSelectOptions(e,l.val(),a,n)})}}},GH.gadget.fields.contextPicker=function(e,t,a,n){return{userpref:a,label:e.getMsg("gh.gadget.common.context"),id:"context_picker_"+a,type:"callbackBuilder",callback:function(i){var l={id:a,name:a},r="select";n&&(l.multiple="multiple",l.size="4",r="multi-select"),i.append(AJS.$("<select>").attr(l).addClass(r));var s=AJS.$("#"+t);GH.gadget.fields.updateContextSelectionOptions(e,s.val(),a),s.change(function(t){GH.gadget.fields.updateContextSelectionOptions(e,s.val(),a)})}}},GH.gadget.fields.tbMappingPicker=function(e,t,a){return{userpref:a,label:e.getMsg("gh.gadget.common.tbcolumns"),id:"tbMapping_picker_"+a,type:"callbackBuilder",callback:function(n){var i={id:a,name:a},l="select";i.multiple="multiple",i.size="4",l="multi-select",n.append(AJS.$("<select>").attr(i).addClass(l));var r=AJS.$("#"+t);GH.gadget.fields.updateTBMappingSelectionOptions(e,r.val(),a),r.change(function(t){GH.gadget.fields.updateTBMappingSelectionOptions(e,r.val(),a)})}}};;
;
/* module-key = 'com.pyxis.greenhopper.jira:gh-rapid-gadget-common', location = 'includes/js/gadgets/rapid/greenhopper-rapid-common.js' */
AJS.$.namespace("GH.gadget.rapid.fields"),GH.gadget.rapid.fields.rapidViewPicker=function(e,t,a){return{userpref:t,label:e.getMsg("gh.gadget.userpref.rapid.view"),id:"rapid_view_picker_"+t,type:"callbackBuilder",callback:function(i){i.append(AJS.$("<select/>").attr({id:t,name:t}).addClass("select"));var d=AJS.$("#"+t);d.empty();var r=e.getPref(t);a.sort(GH.RapidBoard.viewModelComparator),AJS.$(a).each(function(){var e=AJS.$("<option/>").attr("value",this.id).text(this.name);d.append(e),this.id==r&&e.attr({selected:"selected"})}),d.change(function(){var e=d.find("option:selected").attr("value");AJS.$(document).trigger("config.rapidViewChanged",{rapidViewId:e})})}}},GH.gadget.rapid.fields.getSelectedRapidViewId=function(e){return AJS.$("#"+e).find("option:selected").attr("value")},GH.gadget.rapid.fields.quickFilterPicker=function(e,t,a){function i(a,i){AJS.$.ajax({url:GH.Ajax.buildRestUrl("/gadgets/rapidview/pool/quickfilters/")+a,type:"GET",dataType:"json",success:function(a){var d=e.getPref(t).split("|");i.empty(),AJS.$(a).each(function(){var e=AJS.$("<option/>").attr("value",this.id).text(this.name);i.append(e);for(var t=0,a=d.length;t<a;t++)d[t]==this.id&&e.attr("selected","selected")})}})}return{userpref:t,label:e.getMsg("gh.gadget.userpref.quick.filter"),id:"quick_filter_picker_"+t,type:"callbackBuilder",callback:function(e){var d={id:t,name:t},r="multi-select";d.multiple="multiple",d.size="4";var n=AJS.$("<select>").attr(d).addClass(r);e.append(n),AJS.$("<input/>").attr({name:t,type:"hidden",value:"none"}).appendTo(e);var l=GH.gadget.rapid.fields.getSelectedRapidViewId(a);i(l,n),AJS.$(document).bind("config.rapidViewChanged",function(e,t){i(t.rapidViewId,n)})}}},GH.gadget.rapid.fields.sprintPicker=function(e,t,a,i,d){function r(a,r){d(a).done(function(a){var d=e.getPref(t);if(r.empty(),i){var n="auto",l=AJS.$("<option />").addClass("next-release-option").val(n).text(e.getMsg("gh.gadget.sprint.option.auto"));d==n&&l.attr("selected","selected"),r.append(l)}AJS.$.each(a,function(e,t){var a=AJS.$("<option/>").attr("value",t.id).text(t.name);r.append(a),d==t.id&&a.attr("selected","selected")})})}return{userpref:t,label:e.getMsg("gh.gadget.userpref.rapid.view"),id:"sprint_picker_"+t,type:"callbackBuilder",callback:function(e){var i={id:t,name:t},d="select",n=AJS.$("<select>").attr(i).addClass(d);e.append(n);var l=GH.gadget.rapid.fields.getSelectedRapidViewId(a);r(l,n),AJS.$(document).on("config.rapidViewChanged",function(e,t){r(t.rapidViewId,n)})}}},GH.gadget.rapid.fields.versionPicker=function(e,t,a,i){function d(a,d){i(a).done(function(a){var i=e.getPref(t);d.empty(),AJS.$.each(a,function(e,t){var a=AJS.$("<option/>").attr("value",t.id).text(t.name);d.append(a),i==t.id&&a.attr("selected","selected")}),GADGET.GH.versionListUpdatedHandler&&GADGET.GH.versionListUpdatedHandler(a)})}return{userpref:t,label:e.getMsg("gh.gadget.userpref.version"),id:"version_picker_"+t,type:"callbackBuilder",callback:function(e){var i={id:t,name:t},r="select",n=AJS.$("<select>").attr(i).addClass(r);e.append(n);var l=GH.gadget.rapid.fields.getSelectedRapidViewId(a);d(l,n),AJS.$(document).on("config.rapidViewChanged",function(e,t){d(t.rapidViewId,n)})}}};;
;
/* module-key = 'com.pyxis.greenhopper.jira:gh-rapid-gadget-common', location = 'includes/js/gadgets/rapid/greenhopper-rapid-server.js' */
AJS.$.namespace("GH.gadget.rapid.server"),GH.gadget.rapid.server.wrapDeferredWith=function(r,e){var d=AJS.$.Deferred();return r.done(function(r){d.resolve(e(r))}).fail(d.reject),d.promise()},GH.gadget.rapid.server.doLoadSprintsByBoardId=function(r){return GH.Ajax.get({url:"/sprintquery/"+r,deferErrorHandling:!0,data:{includeFutureSprints:!1}},"sprintsByBoard")},GH.gadget.rapid.server.doLoadVersionByBoardId=function(r){return GH.Ajax.get({url:"/xboard/plan/backlog/versions.json",data:{rapidViewId:r}},"versionsListForReport")},GH.gadget.rapid.server.doLoadConfigByBoardId=function(r){return GH.Ajax.get({url:"/xboard/config.json",data:{rapidViewId:r},deferErrorHandling:!0})},GH.gadget.rapid.server.loadOpenSprintsByBoardId=function(r){return GH.gadget.rapid.server.wrapDeferredWith(GH.gadget.rapid.server.doLoadSprintsByBoardId(r),function(r){return _.where(r.sprints,{state:"ACTIVE"})})},GH.gadget.rapid.server.loadVersionsByBoardId=function(r){if(!r){var e=AJS.$.Deferred();return setTimeout(function(){e.resolve([])}),e.promise()}return GH.gadget.rapid.server.wrapDeferredWith(GH.gadget.rapid.server.doLoadVersionByBoardId(r),function(r){var e=[];return _.each(r.versionData.versionsPerProject,function(d,a){e.push(_.map(d,function(e){var d=_.findWhere(r.projects,{id:parseInt(a,10)});return{id:e.id,name:e.name,projectKey:d.key}}))}),_.flatten(e)})},GH.gadget.rapid.server.loadConfigByBoardId=function(r){return GH.gadget.rapid.server.wrapDeferredWith(GH.gadget.rapid.server.doLoadConfigByBoardId(r),function(r){return r.currentViewConfig})};;